<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Ordem de Serviço</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- html2pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    /* --------- Variáveis e reset --------- */
    :root{
      --page-w: 210mm;         /* A4 */
      --page-h: 297mm;         /* A4 */
      --page-pad: 14mm;        /* padding interno da folha */
      --gap: 10px;
      --bord: 1px solid #222;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #eef1f4; margin: 0; padding: 16px 0;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* --------- Toolbar (fora do PDF) --------- */
    .toolbar{
      width: var(--page-w);
      margin: 0 auto 16px auto;
      display: flex; gap: 8px; justify-content: flex-end;
    }
    .btn{
      background:#111; color:#fff; border:0; padding:10px 16px;
      border-radius:8px; cursor:pointer; font-weight:600;
    }

    /* --------- Folha A4 (parte que vai para o PDF) --------- */
    .sheet{
      width: var(--page-w);
      min-height: var(--page-h);
      margin: 0 auto;
      background: #fff; color:#000;
      box-shadow: 0 2px 12px rgba(0,0,0,.08);
      position: relative;
    }
    .content{
      padding: var(--page-pad);
    }

    /* --------- Cabeçalho --------- */
    .header{
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: var(--gap);
      margin-bottom: 10px;
      border-bottom: var(--bord);
      padding-bottom: 8px;
    }
    .title{
      font-size: 20pt; font-weight: 800; letter-spacing: .5px;
    }
    .os-number{
      color: #c70000; font-weight: 800; font-size: 14pt;
      text-align: right;
    }

    /* --------- Seções --------- */
    .section{
      border: var(--bord);
      border-radius: 8px;
      padding: 10px;
      margin-top: 10px;
    }
    .section h3{
      margin: 0 0 8px 0; font-size: 12pt;
    }

    /* --------- Form grid --------- */
    .grid-2{ display:grid; grid-template-columns: 1fr 1fr; gap: var(--gap); }
    .grid-3{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--gap); }
    .grid-4{ display:grid; grid-template-columns: repeat(4, 1fr); gap: var(--gap); }

    label{
      font-size: 10pt; font-weight: 700; display:block; margin-bottom: 3px;
    }
    input, textarea{
      width: 100%; font-size: 11pt; padding: 7px 8px;
      border: 1px solid #666; border-radius: 6px;
    }
    textarea{ resize: vertical; min-height: 70px; }

    /* Horário alinhado */
    .time-row{
      display: flex; align-items: center; gap: 8px;
    }
    .time-row input[type="time"]{ flex: 1; min-width: 0; }

    /* Linha final (totais) */
    .totais{
      display: grid; grid-template-columns: 1fr 1fr; gap: var(--gap);
      margin-top: 10px;
    }

    /* --------- Impressão --------- */
    @page{
      size: A4;
      margin: 0;
    }
    @media print{
      body{ background: #fff; }
      .toolbar{ display:none; }
      .sheet{ box-shadow: none; }
      /* Garante as cores e medidas fiéis na impressão/pdf */
      *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    }
  </style>
</head>
<body>

  <!-- Botões fora da folha (não entram no PDF) -->
  <div class="toolbar">
    <button class="btn" onclick="gerarPDF()">Gerar PDF</button>
  </div>

  <!-- Folha A4 -->
  <div class="sheet" id="sheet">
    <div class="content" id="os">
      <!-- Cabeçalho -->
      <div class="header">
        <div class="title">ORDEM DE SERVIÇO</div>
        <div class="os-number">
          Nº <input id="numero_os" name="numero_os" type="text" style="width:120px;text-align:center;">
        </div>
      </div>

      <!-- Dados do Cliente -->
      <div class="section">
        <h3>Dados do Cliente</h3>
        <div class="grid-2">
          <div>
            <label for="cliente">Cliente</label>
            <input id="cliente" name="cliente" type="text">
          </div>
          <div>
            <label for="fone_cliente">Telefone</label>
            <input id="fone_cliente" name="fone_cliente" type="tel" placeholder="(xx) xxxxx-xxxx">
          </div>
        </div>
        <div class="grid-2" style="margin-top:var(--gap);">
          <div>
            <label for="endereco_cliente">Endereço</label>
            <input id="endereco_cliente" name="endereco_cliente" type="text">
          </div>
          <div>
            <label for="cpf_cnpj">CPF/CNPJ</label>
            <input id="cpf_cnpj" name="cpf_cnpj" type="text">
          </div>
        </div>
      </div>

      <!-- Data e Horário -->
      <div class="section">
        <h3>Agendamento</h3>
        <div class="grid-2">
          <div>
            <label for="data">Data</label>
            <input id="data" name="data" type="date">
          </div>
          <div>
            <label>Horário</label>
            <div class="time-row">
              <input id="hora_inicio" name="hora_inicio" type="time" />
              <span>às</span>
              <input id="hora_fim" name="hora_fim" type="time" />
            </div>
          </div>
        </div>
      </div>

      <!-- Serviço -->
      <div class="section">
        <h3>Serviço</h3>
        <div class="grid-2">
          <div>
            <label for="item">Item/Serviço</label>
            <input id="item" name="item" type="text">
          </div>
          <div>
            <label for="valor">Valor a pagar (R$)</label>
            <input id="valor" name="valor" type="number" step="0.01" min="0">
          </div>
        </div>

        <div style="margin-top:var(--gap);">
          <label for="descricao">Descrição do Serviço</label>
          <textarea id="descricao" name="descricao"></textarea>
        </div>

        <div style="margin-top:var(--gap);">
          <label for="pix">Número do PIX</label>
          <input id="pix" name="pix" type="text" placeholder="chave (celular, CPF/CNPJ, e-mail ou aleatória)">
        </div>
      </div>

      <!-- Prestador -->
      <div class="section">
        <h3>Prestador de Serviço</h3>
        <div class="grid-2">
          <div>
            <label for="prestador">Nome/Razão Social</label>
            <input id="prestador" name="prestador" type="text">
          </div>
          <div>
            <label for="email_prestador">E-mail</label>
            <input id="email_prestador" name="email_prestador" type="email">
          </div>
        </div>

        <div class="grid-2" style="margin-top:var(--gap);">
          <div>
            <label for="fone_prestador">Telefone</label>
            <input id="fone_prestador" name="fone_prestador" type="tel" placeholder="(xx) xxxxx-xxxx">
          </div>
          <div>
            <label for="endereco_prestador">Endereço</label>
            <input id="endereco_prestador" name="endereco_prestador" type="text">
          </div>
        </div>
      </div>

      <!-- Totais / Observações rápidas -->
      <div class="section">
        <div class="totais">
          <div>
            <label for="obs">Observações</label>
            <textarea id="obs" name="obs" style="min-height:60px;"></textarea>
          </div>
          <div>
            <label for="ass">Assinatura do Cliente</label>
            <div style="height:60px;border:1px dashed #666;border-radius:6px;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function gerarPDF(){
      // Captura apenas a "sheet" em tamanho A4 para evitar desalinhamento
      const folha = document.getElementById('sheet');

      // Dica: remover sombra antes do print melhora o recorte
      folha.classList.add('printing');

      const opt = {
        margin:       0, // já temos padding interno na folha
        filename:     'ordem_servico.pdf',
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2, useCORS: true },
        jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' },
        pagebreak:    { mode: ['avoid-all', 'css'] }
      };

      html2pdf().set(opt).from(folha).save().then(() => {
        folha.classList.remove('printing');
      });
    }
  </script>
</body>
</html>
